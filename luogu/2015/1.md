---
_id: "luogu-P2015"
title: "二叉苹果树"
date: 2020-01-27 18:01
update: 2020-01-27 18:01
author: Rainboy
tags:
    - 树形DP
catalog: 树形DP
source: 
    - 
      oj: luogu
      url: https://www.luogu.com.cn/problem/P2015
---

@[toc]

## 题目



### 题目描述

有一棵苹果树，如果树枝有分叉，一定是分2叉（就是说没有只有1个儿子的结点）

这棵树共有N个结点（叶子点或者树枝分叉点），编号为1-N,树根编号一定是1。

我们用一根树枝两端连接的结点的编号来描述一根树枝的位置。下面是一颗有4个树枝的树
```
2   5
 \ / 
  3   4
   \ /
    1
```
现在这颗树枝条太多了，需要剪枝。但是一些树枝上长有苹果。

给定需要保留的树枝数量，求出最多能留住多少苹果。




### 输入格式
第1行2个数，N和Q(1<=Q<= N,1<N<=100)。

N表示树的结点数，Q表示要保留的树枝数量。接下来N-1行描述树枝的信息。

每行3个整数，前两个是它连接的结点的编号。第3个数是这根树枝上苹果的数量。

每根树枝上的苹果不超过30000个。




### 输出格式

一个数，最多能留住的苹果的数量。




### 样例

|----|----|
|输入 #1  |输出 #1  |
|```  |```  \
|5 2  |21  \
|1 3 1  |```  \
|1 4 10  |   \
|2 3 20  |   \
|3 5 20  |   \
|  |   \
|```  |   |




## 解析

显然

 - 树根一定要保留.
 - 要用结点代替边的编号
 - 保留q个边,就是保留q+1个结点

这显然是可以按孩子来进行的递归的问题,显然要用dfs+记忆化DP


设$f[i][j]$以i为根的子树保留中,保留j个结点得到的最大值.

$$
f[i][j] = max{ f[lson_i][x],f[rson_i][y]} + a[i]\\
x + y  == j-1
$$

初始化:

 - $f[i][0] = 0$
 - $f[i][1] = a[i]$,i为叶子结点
 - $a[1] = 0$

答案$ans = f[1][q+1]$


## 代码

```c
<%- include("1.cpp") %>
```
