---
_id: "luogu-P1338"
title: "P1338 末日的传说 "
date: 2020-01-01 15:43
update: 2020-01-01 15:43
author: Rainboy
tags:
    - 逆序对
    - 思维
    - 好题
catalog: 思维
source: 
    - 
      oj: luogu
      url: https://www.luogu.com.cn/problem/P1338
---

@[toc]

## 解析

题目核心: 如何构造固定逆序对个数的字典序最小的序列.

### 思考1

 - 全排列: next_permutation
 - 求逆序对: BIT
时间复杂度:$O(n!nlogn)$,爆炸!

### 思考2

逆序对的最大个数:$n*(n-1)/2$

取出一个最小的数,如果这个数可以放最前面($ \sum_{1}^{n-i}i \geqslant m$),那就放最前面,不能,依次找第2,第3小的数尝试.

如果放第二小的数x在最前面,那么x会和第1小的数形成逆序对数1,所以x的贡献是1,后面m应该为$m-1$

递归即可.

但是,发现递归的过程中需要用for来查找,且$n=50000$,所以会超时

### 思考3

核心解法:每一次取一个最下数,这个数不是在最前面,就是在最后面.

放前面容易想,为什么要放最后面呢? 其实只要模拟一遍就容易想出来:放在最后会让字典序尽可能的小.

参考这个题解: https://www.luogu.com.cn/blog/user11765/solution-p1338


## 代码

```c
<%- include("1.cpp") %>
```


没有考虑到应该放到最后面,超时的代码

### TLE CODE

::: fold
```c
<%- include("1_tle.cpp") %>
```
:::
