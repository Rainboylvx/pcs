---
_id: "luogu-P7074"
title: "[CSP-J2020] 方格取数"
date: 2021-06-13 15:12
update: 2021-06-13 15:12
author: Rainboy
tags:
    - DP
    - 动态规划
    - noip
    - csp
    - 普及组
catalog: 动态规划
source:
      oj: luogu
      url: https://www.luogu.com.cn/problem/P7074
---

@[toc]

## 题目



### 题目描述

设有 $n \times m$ 的方格图，每个方格中都有一个整数。现有一只小熊，想从图的左上角走到右下角，每一步只能向上、向下或向右走一格，并且不能重复经过已经走过的方格，也不能走出边界。小熊会取走所有经过的方格中的整数，求它能取到的整数之和的最大值。



### 输入格式
第一行有两个整数 $n, m$。

接下来 $n$ 行每行 $m$ 个整数，依次代表每个方格中的整数。



### 输出格式

一个整数，表示小熊能取到的整数之和的最大值。



### 样例

|----|----|
|输入 #1  |输出 #1  |
|```  |```  \
|3 4  |9  \
|1 -1 3 2  |```  \
|2 -1 4 -1  |   \
|-2 2 -3 -1  |   \
|  |   \
|```  |   |
|输入 #2  |输出 #2  |
|```  |```  \
|2 5  |-10  \
|-1 -1 -3 -2 -7  |```  \
|-2 -1 -4 -1 -2  |   \
|  |   \
|```  |   |



### 说明/提示
### 样例 1 解释

![](https://cdn.luogu.com.cn/upload/image_hosting/sq4638pa.png)
---

### 样例 2 解释

![](https://cdn.luogu.com.cn/upload/image_hosting/7tfdyabk.png)
---

### 数据规模与约定
- 对于 $20\%$ 的数据，$n, m \le 5$。
- 对于 $40\%$ 的数据，$n, m \le 50$。
- 对于 $70\%$ 的数据，$n, m \le 300$。
- 对于 $100\%$ 的数据，$1 \le n,m \le 10^3$。方格中整数的绝对值不超过 $10^4$。


## 解析

状态转移方程：

设每个格子有两个值`f1[i][j],f2[i][j]`

 - f1[i][j] 从左，和上来到格子i，j的最大值
 - f2[i][j] 从左，和下来到格子i，j的最大值

第一列，只能从上到下走

f1[i][1] = f2[i][1] = 第一列的前缀和

$$
f1[i][j] = max\{ max(f1[i-1][j],f2[i-1][j]),f1[i-1][j]\} + mg[i][j]
$$

$$
f2[i][j] = max\{ max(f1[i-1][j],f2[i-1][j]),f2[i+1][j]\} + mg[i][j]
$$

## 代码

暴力dfs，拿到25

::: fold
```c
<%- include("t1.cpp") %>
```
:::


DP，没有用int，拿到90
::: fold
```c
<%- include("t2.cpp") %>
```
:::


DP，用long long，拿到100
```c
<%- include("t3.cpp") %>
```


