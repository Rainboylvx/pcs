---
_id: "luogu-P2671"
title: "求和"
date: 2020-05-11 10:31
update: 2020-05-11 10:31
author: Rainboy
tags:
    - 思维
    - 数学
catalog: 思维
source: 
    - 
      oj: luogu
      url: https://www.luogu.com.cn/problem/P2671
---

@[toc]

## 题目



### 题目描述

一条狭长的纸带被均匀划分出了$n$个格子，格子编号从$1$到$n$。每个格子上都染了一种颜色$color\_i$用$[1,m]$当中的一个整数表示），并且写了一个数字$number\_i$。

 ![](https://cdn.luogu.com.cn/upload/pic/1829.png) 

定义一种特殊的三元组：$(x,y,z)$，其中$x,y,z$都代表纸带上格子的编号，这里的三元组要求满足以下两个条件：

1. $xyz$是整数,$x<y<z,y-x=z-y$

2. $colorx=colorz$

满足上述条件的三元组的分数规定为$(x+z) \times (number\_x+number\_z)$。整个纸带的分数规定为所有满足条件的三元组的分数的和。这个分数可能会很大，你只要输出整个纸带的分数除以$10,007$所得的余数即可。




### 输入格式
第一行是用一个空格隔开的两个正整数$n$和$m,n$表纸带上格子的个数，$m$表纸带上颜色的种类数。

第二行有$n$用空格隔开的正整数，第$i$数字$number$表纸带上编号为$i$格子上面写的数字。

第三行有$n$用空格隔开的正整数，第$i$数字$color$表纸带上编号为$i$格子染的颜色。




### 输出格式

一个整数，表示所求的纸带分数除以$10007$所得的余数。




### 样例

|----|----|
|输入 #1  |输出 #1  |
|```  |```  \
|6 2  |82  \
|5 5 3 2 2 2  |  \
|2 2 1 1 2 1  |```  \
|```  |   |
|输入 #2  |输出 #2  |
|```  |```  \
|15 4  |1388  \
|5 10 8 2 2 2 9 9 7 7 5 6 4 2 4  |```  \
|2 2 3 3 4 3 3 2 4 4 4 4 1 1 1  |   \
|```  |   |



### 说明/提示
【输入输出样例 1 说明】

纸带如题目描述中的图所示。

所有满足条件的三元组为： $(1, 3, 5), (4, 5, 6)$。

所以纸带的分数为$(1 + 5) \times (5 + 2) + (4 + 6) \times (2 + 2) = 42 + 40 = 82$。


对于第 $1$ 组至第 $2$ 组数据， $1 ≤ n ≤ 100, 1 ≤ m ≤ 5$；

对于第$ 3$ 组至第 $4$ 组数据， $1 ≤ n ≤ 3000, 1 ≤ m ≤ 100$；

对于第 $5$ 组至第$ 6 $组数据， $1 ≤ n ≤ 100000, 1 ≤ m ≤ 100000$，且不存在出现次数超过$ 20 $的颜色；

对 于 全 部 $10$ 组 数 据 ， $1 ≤ n ≤ 100000, 1 ≤ m ≤ 100000, 1 ≤ color\_i ≤ m,1≤number\_i≤100000$



## 解析

测试数据生成程序下载:[点击下载](./data_generator.py)

显然,可以想到一个暴力枚举的$O(n^2)$的算法,但是会超时.

发现一个规律:x,z必须同为偶数或奇数,显然每种颜色奇数,偶数位置分别形成一组,最终会形成2m组,针对每一组计算3种前缀和即可.

主要得到公式.


真正需要的信息的是这一组的值和与数量.


学会了:对于mod来说,一定要多加括号,多mod

## 代码

```c
<%- include("1.cpp") %>
```

## 参考

- [题解 P2671 【求和】 - Flash千殇 的博客 - 洛谷博客](https://www.luogu.com.cn/blog/ShanXian/solution-p2671)
